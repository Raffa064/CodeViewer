<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>New preview</title>
    <style>
        * {
            padding: 0;
            margin: 0;
            border: none;
            outline: none;
            box-sizing: border-box;
            font-family: Arial, Helvetica, sans-serif;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -ms-user-select: none;
            -moz-user-select: none;
            -ms-touch-select: none;
        }

        body {
            min-width: 100vw;
            min-height: 100vh;
            display: grid;
            background: #222;
            grid-template-areas: 'preview'
                'editor';
            grid-template-rows: .8fr 1fr;
            grid-template-columns: 1fr;
        }

        @media (min-width: 800px) {
            body {
                grid-template-areas: 'preview editor';
                grid-template-rows: 1fr;
                grid-template-columns: 1fr 1fr;
            }
        }

        #preview {
            grid-area: preview;
        }

        #editor {
            grid-area: editor;
            color: #aaa;
            padding: 10px;
            overflow: scroll;
        }

        iframe {
            width: 100%;
            height: 100%;
        }

        label {
            color: #eee;
        }

        input,
        textarea {
            width: 100%;
            max-height: 300px;
            margin-block: 6px;
            padding: 10px;
            border-radius: 5px;
            background: #eee;
            resize: none;
        }

        input[type="checkbox"] {
            width: initial;
        }

        select {
            margin-block: 4px;
            padding: 8px;
            border: 1px solid #fff1;
            border-radius: 5px;
            background: transparent;
            color: #fff;
        }

        input+.toggler-label+.toggle {
            display: none;
        }

        input+.toggler-label+.toggle+.toggle {
            display: block;
        }

        input:checked+.toggler-label+.toggle {
            display: block;
        }

        input:checked+.toggler-label+.toggle+.toggle {
            display: none;
        }

        .toggle {
            padding: 7px;
            border: 1px solid #fff2;
            border-radius: 4px;
        }

        #output-url {
            display: block;
            padding: 10px;
            color: #aaa;
            border: 1px solid #fff3;
            border-radius: 4px;
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
            text-align: center;
            margin-top: 5px;
        }

        #output-url:hover {
            color: #ddd;
            border: 1px solid #fff6;
        }

        #output-url.sucess {
            color: #0fd;
            border: 1px solid #0fd6;
        }

        #output-url.error {
            color: #f40;
            border: 1px solid #f406;
        }
    </style>
</head>

<body>
    <div id="preview">
        <iframe id="if-preview" src="index.html" frameborder="0"></iframe>
    </div>
    <div id="editor">
        <label>Shiki theme</label><br />
        <select oninput="updatePreview()" id="select-theme">
            <option value="css-variables">css-variables</option>
            <option value="dark-plus">dark-plus</option>
            <option value="dracula-soft">dracula-soft</option>
            <option value="dracula">dracula</option>
            <option value="github-dark-dimmed">github-dark-dimmed</option>
            <option value="github-dark" selected="true">github-dark</option>
            <option value="github-light">github-light</option>
            <option value="hc_light">hc_light</option>
            <option value="light-plus">light-plus</option>
            <option value="material-theme-darker">material-theme-darker</option>
            <option value="material-theme-lighter">material-theme-lighter</option>
            <option value="material-theme-ocean">material-theme-ocean</option>
            <option value="material-theme-palenight">material-theme-palenight</option>
            <option value="material-theme">material-theme</option>
            <option value="min-dark">min-dark</option>
            <option value="min-light">min-light</option>
            <option value="monokai">monokai</option>
            <option value="nord">nord</option>
            <option value="one-dark-pro">one-dark-pro</option>
            <option value="poimandres">poimandres</option>
            <option value="rose-pine-dawn">rose-pine-dawn</option>
            <option value="rose-pine-moon">rose-pine-moon</option>
            <option value="rose-pine">rose-pine</option>
            <option value="slack-dark">slack-dark</option>
            <option value="slack-ochin">slack-ochin</option>
            <option value="solarized-dark">solarized-dark</option>
            <option value="solarized-light">solarized-light</option>
            <option value="vitesse-dark">vitesse-dark</option>
            <option value="vitesse-light">vitesse-light</option>
        </select>
        <br />

        <label>Title color</label><br />
        <input oninput="updatePreview()" id="title-color" type="text" placeholder="Empty to default (HEX: #ff000070)"/>
        <br />

        <label>File name</label><br />
        <input oninput="updatePreview()" id="name" placeholder="Empty to default (FILE: Example.txt)" />
        <br />

        <input oninput="updatePreview()" name="toggle-url-mode" id="toggle-url-mode" type="checkbox" />
        <label class="toggler-label" for="toggle-url-mode">Use code from url</label>

        <div class="toggle">
            <label>Code url</label><br />
            <input oninput="updatePreview()" placeholder="Code url" id="code-url" />
        </div>

        <div class="toggle">
            <label>Plain text code</label><br />
            <textarea oninput="updatePreview()" placeholder="Short code plain text" id="code">console.log('Code Viewer');</textarea>
            <p style="font-size: 0.8rem; color: #f00;">* Don't recommended for long code</p>
        </div>
        <br />

        <label>Code lenguage</label><br />
        <select oninput="updatePreview()" id="select-lang">
            <option value="abap">abap</option>
            <option value="actionscript-3">actionscript-3</option>
            <option value="ada">ada</option>
            <option value="apache">apache</option>
            <option value="apex">apex</option>
            <option value="apl">apl</option>
            <option value="applescript">applescript</option>
            <option value="ara">ara</option>
            <option value="asm">asm</option>
            <option value="astro">astro</option>
            <option value="awk">awk</option>
            <option value="ballerina">ballerina</option>
            <option value="bat">bat</option>
            <option value="batch">batch</option>
            <option value="beancount">beancount</option>
            <option value="berry">berry</option>
            <option value="be">be</option>
            <option value="bibtex">bibtex</option>
            <option value="bicep">bicep</option>
            <option value="blade">blade</option>
            <option value="c">c</option>
            <option value="cadence">cadence</option>
            <option value="cdc">cdc</option>
            <option value="clarity">clarity</option>
            <option value="clojure">clojure</option>
            <option value="clj">clj</option>
            <option value="cmake">cmake</option>
            <option value="cobol">cobol</option>
            <option value="codeql">codeql</option>
            <option value="ql">ql</option>
            <option value="coffee">coffee</option>
            <option value="cpp">C++</option>
            <option value="crystal">crystal</option>
            <option value="csharp">C#</option>
            <option value="cs">cs</option>
            <option value="css">css</option>
            <option value="cue">cue</option>
            <option value="cypher">cypher</option>
            <option value="cql">cql</option>
            <option value="d">d</option>
            <option value="dart">dart</option>
            <option value="dax">dax</option>
            <option value="diff">diff</option>
            <option value="docker">docker</option>
            <option value="dockerfile">dockerfile</option>
            <option value="dream-maker">dream-maker</option>
            <option value="elixir">elixir</option>
            <option value="elm">elm</option>
            <option value="erb">erb</option>
            <option value="erlang">erlang</option>
            <option value="erl">erl</option>
            <option value="fish">fish</option>
            <option value="f#">f#</option>
            <option value="fs">fs</option>
            <option value="gdresource">gdresource</option>
            <option value="gdscript">gdscript</option>
            <option value="gdshader">gdshader</option>
            <option value="gherkin">gherkin</option>
            <option value="git-commit">git-commit</option>
            <option value="git-rebase">git-rebase</option>
            <option value="glimmer-js">glimmer-js</option>
            <option value="gjs">gjs</option>
            <option value="glimmer-ts">glimmer-ts</option>
            <option value="gts">gts</option>
            <option value="glsl">glsl</option>
            <option value="gnuplot">gnuplot</option>
            <option value="go">go</option>
            <option value="graphql">graphql</option>
            <option value="groovy">groovy</option>
            <option value="hack">hack</option>
            <option value="haml">haml</option>
            <option value="handlebars">handlebars</option>
            <option value="hbs">hbs</option>
            <option value="haskell">haskell</option>
            <option value="hs">hs</option>
            <option value="hcl">hcl</option>
            <option value="hjson">hjson</option>
            <option value="hlsl">hlsl</option>
            <option value="html">html</option>
            <option value="http">http</option>
            <option value="imba">imba</option>
            <option value="ini">ini</option>
            <option value="properties">properties</option>
            <option value="java">java</option>
            <option value="javascript">javascript</option>
            <option value="js" selected="true">js</option>
            <option value="jinja-html">jinja-html</option>
            <option value="jison">jison</option>
            <option value="json">json</option>
            <option value="json5">json5</option>
            <option value="jsonc">jsonc</option>
            <option value="jsonl">jsonl</option>
            <option value="jsonnet">jsonnet</option>
            <option value="jssm">jssm</option>
            <option value="fsl">fsl</option>
            <option value="jsx">jsx</option>
            <option value="julia">julia</option>
            <option value="kotlin">kotlin</option>
            <option value="kusto">kusto</option>
            <option value="kql">kql</option>
            <option value="latex">latex</option>
            <option value="less">less</option>
            <option value="liquid">liquid</option>
            <option value="lisp">lisp</option>
            <option value="logo">logo</option>
            <option value="lua">lua</option>
            <option value="make">make</option>
            <option value="makefile">makefile</option>
            <option value="markdown">markdown</option>
            <option value="md">md</option>
            <option value="marko">marko</option>
            <option value="matlab">matlab</option>
            <option value="mdx">mdx</option>
            <option value="mermaid">mermaid</option>
            <option value="narrat">narrat</option>
            <option value="nar">nar</option>
            <option value="nextflow">nextflow</option>
            <option value="nf">nf</option>
            <option value="nginx">nginx</option>
            <option value="nim">nim</option>
            <option value="nix">nix</option>
            <option value="objective-c">objective-c</option>
            <option value="objc">objc</option>
            <option value="objective-cpp">objective-cpp</option>
            <option value="ocaml">ocaml</option>
            <option value="pascal">pascal</option>
            <option value="perl">perl</option>
            <option value="php">php</option>
            <option value="plsql">plsql</option>
            <option value="postcss">postcss</option>
            <option value="powerquery">powerquery</option>
            <option value="powershell">powershell</option>
            <option value="ps">ps</option>
            <option value="ps1">ps1</option>
            <option value="prisma">prisma</option>
            <option value="prolog">prolog</option>
            <option value="proto">proto</option>
            <option value="pug">pug</option>
            <option value="jade">jade</option>
            <option value="puppet">puppet</option>
            <option value="purescript">purescript</option>
            <option value="python">python</option>
            <option value="py">py</option>
            <option value="r">r</option>
            <option value="raku">raku</option>
            <option value="perl6">perl6</option>
            <option value="razor">razor</option>
            <option value="reg">reg</option>
            <option value="rel">rel</option>
            <option value="riscv">riscv</option>
            <option value="rst">rst</option>
            <option value="ruby">ruby</option>
            <option value="rb">rb</option>
            <option value="rust">rust</option>
            <option value="rs">rs</option>
            <option value="sas">sas</option>
            <option value="sass">sass</option>
            <option value="scala">scala</option>
            <option value="scheme">scheme</option>
            <option value="scss">scss</option>
            <option value="shaderlab">shaderlab</option>
            <option value="shader">shader</option>
            <option value="shellscript">shellscript</option>
            <option value="bash">bash</option>
            <option value="sh">sh</option>
            <option value="shell">shell</option>
            <option value="zsh">zsh</option>
            <option value="shellsession">shellsession</option>
            <option value="console">console</option>
            <option value="smalltalk">smalltalk</option>
            <option value="solidity">solidity</option>
            <option value="sparql">sparql</option>
            <option value="sql">sql</option>
            <option value="ssh-config">ssh-config</option>
            <option value="stata">stata</option>
            <option value="stylus">stylus</option>
            <option value="styl">styl</option>
            <option value="svelte">svelte</option>
            <option value="swift">swift</option>
            <option value="system-verilog">system-verilog</option>
            <option value="tasl">tasl</option>
            <option value="tcl">tcl</option>
            <option value="tex">tex</option>
            <option value="toml">toml</option>
            <option value="tsx">tsx</option>
            <option value="turtle">turtle</option>
            <option value="twig">twig</option>
            <option value="typescript">typescript</option>
            <option value="ts">ts</option>
            <option value="v">v</option>
            <option value="vb">vb</option>
            <option value="cmd">cmd</option>
            <option value="verilog">verilog</option>
            <option value="vhdl">vhdl</option>
            <option value="viml">viml</option>
            <option value="vim">vim</option>
            <option value="vimscript">vimscript</option>
            <option value="vue-html">vue-html</option>
            <option value="vue">vue</option>
            <option value="vyper">vyper</option>
            <option value="vy">vy</option>
            <option value="wasm">wasm</option>
            <option value="wenyan">wenyan</option>
            <option value="wgsl">wgsl</option>
            <option value="wolfram">wolfram</option>
            <option value="xml">xml</option>
            <option value="xsl">xsl</option>
            <option value="yaml">yaml</option>
            <option value="yml">yml</option>
            <option value="zenscript">zenscript</option>
        </select>
        <br />

        <label>Output url</label><br />
        <span id="output-url">https://raffa064.github.io/CodeViewer</span>
    </div>

    <script>
        // Elements
        const iframeElt = document.querySelector('#if-preview')
        const selectThemeElt = document.querySelector('#select-theme')
        const titleColorElt = document.querySelector('#title-color')
        const toggleUrlModeElt = document.querySelector('#toggle-url-mode')
        const codeUrlElt = document.querySelector('#code-url')
        const codeElt = document.querySelector('#code')
        const selectLangElt = document.querySelector('#select-lang')
        const nameElt = document.querySelector('#name')
        const outputUrlElt = document.querySelector('#output-url')

        //Click and Copy url link
        outputUrlElt.onclick = () => {
            const changeText = (text, modifier) => {
                const span = document.createElement('span')
                span.id = "output-url"
                span.classList.add(modifier)
                span.innerText = text

                outputUrlElt.replaceWith(span)

                setTimeout(() => {
                    span.replaceWith(outputUrlElt)
                }, 2000)
            }

            navigator.clipboard.writeText(outputUrlElt.innerText)
                .then(() => {
                    changeText('Copied to clipboard!', 'sucess')
                }).catch((err) => {
                    changeText('No clipboard permission...', 'error')
                })
        }

        updatePreview()

        function updatePreview() {
            var theme = selectThemeElt.value
            var titleColor = titleColorElt.value
            var codeMode = toggleUrlModeElt.checked ? "code-url" : "code"
            var code = toggleUrlModeElt.checked ? codeUrlElt.value : encodeURI(codeElt.value)
            var lang = selectLangElt.value
            var name = encodeURI(nameElt.value)

            titleColor = titleColor.substring(1, titleColor.length) // Remove #

            const HOST = 'https://raffa064.github.io/CodeViewer' //window.location.protocol + "//" + window.location.host
            const url = HOST+`?light=${isLight(theme)}&theme=${theme}&title-color=${titleColor}&${codeMode}=${code}&lang=${lang}&name=${name}`
            iframeElt.contentWindow.location.replace(url)

            outputUrlElt.innerText = url;
        }

        function isLight(theme) {
            return ({
                'css-variables': true,
                'dark-plus': false,
                'dracula-soft': false,
                'dracula': false,
                'github-dark-dimmed': false,
                'github-dark': false,
                'github-light': true,
                'hc_light': false,
                'light-plus': true,
                'material-theme-darker': false,
                'material-theme-lighter': true,
                'material-theme-ocean': false,
                'material-theme-palenight': false,
                'material-theme': false,
                'min-dark': false,
                'min-light': true,
                'monokai': false,
                'nord': false,
                'one-dark-pro': false,
                'poimandres': false,
                'rose-pine-dawn': true,
                'rose-pine-moon': false,
                'rose-pine': false,
                'slack-dark': false,
                'slack-ochin': true,
                'solarized-dark': false,
                'solarized-light': true,
                'vitesse-dark': false,
                'vitesse-light': true
            })[theme]
        }
    </script>
</body>

</html>